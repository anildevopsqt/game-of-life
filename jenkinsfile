pipeline{
    agent{ label 'maven_jdk'} 
    triggers { cron ('H/15 * * * *')}
    parameter {
        string(name:'MAVEN_GOAL', defaultValue:'package', description:'maven goal')
    }
    stages{
        stage('vcs'){
            steps {
            git branch: 'declarative', url: 'https://github.com/anildevopsqt/game-of-life.git'
            }
        }
        stage('build'){
            tools{jdk 'JDK_8'}
            steps {
            sh "mvn ${params.MAVEN_GOAL}"
        }
                }
        }
        stage('postbuild'){
            steps{
                archiveArtifacts artifacts: '**/target/gameoflife.war',
                                 onlyIfSuccessful: true
                junit testResults: '**/surefire-report/TEST-*.xml',
                  allowEmptyResults : true
        }

        }
       post {
        sucess {
            mail subject: "jenkins build of ${JOB_NAME} with id ${BUILD_ID} is sucess",
                     body: "use this url ${BUILD_URL} for more info",
                     to: 'team-All-veluru.anil2009@gmail.com',
                     from:'devopsqt@.com'
        failure{
            mail subject: "jenkins build of ${JOB_NAME} with id ${BUILD_ID} is failure",
                    body:"use this url ${BUILD_URL} for more info",
                    to:"${GIT_AUT_EMAI}L",
                    from:'devopsqt@.com'
        }             
            
        }
       }            
     }
