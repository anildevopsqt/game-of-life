pipeline{
    agent{ label 'maven_jdk'} 
    triggers { cron ('H/15 * * * *')}
    parameters {
        string(name:'MAVEN_GOAL', defaultValue:'package', description:'maven goal')
    }
    stages{
        stage('vcs'){
            steps {
            git branch: 'declarative', url: 'https://github.com/anildevopsqt/game-of-life.git'
            }
        }
        stage('build'){
            tools{jdk 'JDK_8'}
            steps {
            sh "mvn ${params.MAVEN_GOAL}"
        }
                }
        
        stage('post build'){
            steps{
                archiveArtifacts artifacts: '**/target/gameoflife.war',
                                 onlyIfSuccessful: true
                junit testResults: '**/surefire-report/TEST-*.xml',
                  allowEmptyResults : true
        }
        }


        }
       post {
        success {
            mail subject: "jenkins build of ${JOB_NAME} with id ${BUILD_ID} is sucess",
                     body: "use this url ${BUILD_URL} for more info",
                     to: 'team-All-veluru.anil2009@gmail.com',
                     from:'devopsqt@gmail.com'
        /* failure{
            mail subject: "jenkins build of ${JOB_NAME} with id ${BUILD_ID} is failure",
                    body:"use this url ${BUILD_URL} for more info",
                    to:'anil@gmail.com',
                    from:'devopsqt@gmail.com'
        }*/             
            
        }
       }            
     }
